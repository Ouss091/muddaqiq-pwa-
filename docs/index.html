<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ø§Ù„Ù…Ø¯Ù‚Ù‘Ù‚ Ø§Ù„Ù„ØºÙˆÙŠ</title>
  <meta name="theme-color" content="#121212"/>
  <style>
    :root{--bg:#121212;--fg:#fff;--card:#1e1e1e;--accent:#3A86FF;--gold:#FFD166;}
    *{box-sizing:border-box;font-family:'Noto Naskh Arabic', system-ui, sans-serif}
    body{margin:0;background:var(--bg);color:var(--fg)}
    header{position:sticky;top:0;background:#222;padding:12px;font-size:20px;text-align:center}
    .wrap{max-width:900px;margin:0 auto;padding:16px}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{padding:8px 12px;border-radius:999px;border:1px solid #444;background:#0000;cursor:pointer}
    .chip.on{border-color:var(--accent);background:rgba(58,134,255,.18)}
    .chip.all.on{border-color:var(--gold);background:rgba(255,209,102,.25)}
    textarea{width:100%;min-height:48vh;background:var(--card);color:var(--fg);border:1px solid #333;border-radius:16px;padding:16px;font-size:18px;line-height:1.7}
    .bar{position:fixed;left:0;right:0;bottom:0;padding:12px;background:#121212}
    .row{display:flex;gap:10px}
    button{flex:1;padding:14px 16px;border-radius:14px;border:none;color:#fff;background:var(--accent);font-size:16px}
    button.tonal{background:#2a2a2a}
    .hint{opacity:.85;font-size:14px;margin:8px 2px}
  </style>
</head>
<body>
  <header>ðŸ“– Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ù„ØºÙˆÙŠ</header>

  <div class="wrap">
    <div class="chips">
      <div class="chip" id="chip-lang">ØªØµØ­ÙŠØ­ Ø§Ù„Ù„ØºØ©</div>
      <div class="chip on" id="chip-spell">ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¥Ù…Ù„Ø§Ø¡</div>
      <div class="chip" id="chip-meaning">ØªØµØ­ÙŠØ­ Ø§Ù„Ù…Ø¹Ù†Ù‰</div>
      <div class="chip all" id="chip-all">Ø§Ù„ÙƒÙ„ ðŸŒŸ</div>
    </div>

    <p class="hint">Ø§ÙƒØªØ¨ Ù†ØµÙƒ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ø¶ØºØ· Â«ØªØ¯Ù‚ÙŠÙ‚Â»</p>
    <textarea id="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§..."></textarea>
  </div>

  <div class="bar">
    <div class="wrap">
      <div class="row">
        <button id="btn-proof">ØªØ¯Ù‚ÙŠÙ‚</button>
        <button class="tonal" id="btn-style">ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø³Ù„ÙˆØ¨</button>
      </div>
    </div>
  </div>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    const S={fixLang:false,spell:true,meaning:false,all:false};
    const $=s=>document.querySelector(s);
    const toggle=(k)=>{ S[k]=!S[k]; S.all=false; render(); };
    const render=()=>{
      $('#chip-lang').classList.toggle('on',S.fixLang);
      $('#chip-spell').classList.toggle('on',S.spell);
      $('#chip-meaning').classList.toggle('on',S.meaning);
      $('#chip-all').classList.toggle('on',S.all);
    };
    $('#chip-lang').onclick=()=>toggle('fixLang');
    $('#chip-spell').onclick=()=>toggle('spell');
    $('#chip-meaning').onclick=()=>toggle('meaning');
    $('#chip-all').onclick=()=>{
      S.all=!S.all; S.fixLang=S.spell=S.meaning=S.all; render();
    };
    render();

    // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ù†ØµÙˆØµ Ø¨Ø³ÙŠØ·Ø©
    const norm = t => t.replaceAll('?', 'ØŸ').replaceAll(',', 'ØŒ').replace(/Ù€+/g,'')
      .replace(/(ØŒ|Ø›|:|!|ØŸ)([^\s\n\r])/g,(_,p1,p2)=>p1+' '+p2)
      .replace(/\s+(?=(ØŒ|Ø›|:|!|ØŸ))/g,'')
      .replace(/(\S)\s{2,}(\S)/g,'$1 $2');
    const lang = t => t.replace(/\bØ¬Ø¯Ø§\b/g,'Ø¬Ø¯Ù‹Ù‘Ø§')
      .replace(/(^|[\.!ØŸ]\s+)(ÙŠÙˆØ¬Ø¯\s)/g,(_,p1)=>p1+'Ù‡Ù†Ø§Ùƒ ');
    const meaning = t => t.replace(/Ø°Ù„Ùƒ\s+Ø§Ù„Ø£Ù…Ø±/g,'Ø°Ù„Ùƒ')
      .replace(/(\b[\u0600-\u06FF]+\b)\s+\1/g,'$1');
    const style = t => t.replace(/\s+/g,' ').trim()
      .replace(/\bØ­Ù‚Ø§\b/g,'Ø­Ù‚Ù‹Ù‘Ø§').replace(/\bØ¨Ø§Ù„Ø±ØºÙ…\b/g,'Ø¹Ù„Ù‰ Ø§Ù„Ø±ØºÙ…');

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„
    $('#btn-proof').onclick=()=>{
      const ta=$('#text'); let t=ta.value;
      const useAll=S.all, doLang=S.fixLang||useAll, doSpell=S.spell||useAll, doMeaning=S.meaning||useAll;
      if(doSpell) t=norm(t);
      if(doLang) t=lang(t);
      if(doMeaning) t=meaning(t);
      ta.value=t;
    };
    $('#btn-style').onclick=()=>{
      const ta=$('#text'); ta.value=style(ta.value);
    };
  </script>
</body>
</html>
